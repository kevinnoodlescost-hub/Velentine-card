<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Thiá»‡p Valentine</title>

  <style>
    :root{
      --bg1:#ff9a9e;
      --bg2:#fad0c4;
      --cardW: min(860px, calc(100vw - 28px));
      --radius: clamp(14px, 2.8vw, 22px);
      --pad: clamp(16px, 3.8vw, 36px);
      --h1: clamp(22px, 3.6vw, 36px);
      --h2: clamp(18px, 3vw, 28px);
      --p:  clamp(14px, 2.1vw, 18px);
      --btn: clamp(14px, 2.1vw, 16px);
      --shadow: 0 12px 34px rgba(0,0,0,0.22);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: "Segoe UI", sans-serif;
      background: linear-gradient(135deg,var(--bg1),var(--bg2));
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      text-align:center;
    }

    /* Tim ná»n */
    .heart{
      position:fixed;
      z-index:1;
      pointer-events:none;
      opacity:0;
      will-change:transform, opacity;
      animation: floatUp linear forwards;
      filter: drop-shadow(0 4px 10px rgba(0,0,0,0.18));
    }
    @keyframes floatUp{
      0%   { transform: translate(var(--x0), 110vh) rotate(0deg); opacity:0; }
      12%  { opacity:1; }
      100% { transform: translate(var(--x1), -20vh) rotate(360deg); opacity:0; }
    }

    /* âœ… (2) áº¢nh ná»n bay lÆ¡ lá»­ng (náº±m giá»¯a hearts vÃ  panel) */
    .floatImg{
      position:fixed;
      z-index:2;               /* > hearts (1) vÃ  < stage/panel (3) */
      pointer-events:none;
      opacity:0;
      will-change:transform, opacity;
      filter: drop-shadow(0 10px 24px rgba(0,0,0,0.18));
      animation: floatImgUp linear infinite;
      transform: translate(var(--x0), 110vh) rotate(var(--r0));
      border-radius: 16px;
    }
    @keyframes floatImgUp{
      0%   { transform: translate(var(--x0), 112vh) rotate(var(--r0)); opacity:0; }
      10%  { opacity: .40; }
      50%  { opacity: .46; }
      92%  { opacity: .30; }
      100% { transform: translate(var(--x1), -28vh) rotate(var(--r1)); opacity:0; }
    }

    .stage{ position:relative; z-index:3; width:var(--cardW); }

    .panel{
      background:#fff;
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      padding:var(--pad);
      margin: 0 auto;
    }

    .title{ font-size:var(--h1); margin:0 0 10px 0; line-height:1.15; }
    .subtitle{ font-size:var(--h2); margin:0 0 12px 0; line-height:1.25; }
    .text{ font-size:var(--p); line-height:1.7; margin:0 0 14px 0; }

    .btnRow{
      display:flex;
      gap:12px;
      justify-content:center;
      flex-wrap:wrap;
      margin-top: 12px;
    }

    button{
      border:none;
      border-radius:999px;
      padding: clamp(10px, 2.5vw, 12px) clamp(16px, 4.2vw, 26px);
      font-size:var(--btn);
      cursor:pointer;
      color:#fff;
      background:#ff4d6d;
      transition: transform .08s ease, opacity .2s ease;
    }
    button:hover{ opacity:.92; }
    button:active{ transform: translateY(1px); }

    .btnGhost{ background:#111; opacity:.85; }

    .scene{ display:none; }
    .scene.active{ display:block; }

    /* ===== Envelope ===== */
    .envelopeWrap{
      display:grid;
      place-items:center;
      gap:16px;
    }

    .envelope{
      width: min(520px, 92vw);
      aspect-ratio: 16/10;
      position:relative;
      border-radius:18px;
      background: #f7f2ee;
      box-shadow: 0 10px 26px rgba(0,0,0,0.18);
      overflow:hidden;
    }

    .env-body{
      position:absolute; inset:0;
      background: linear-gradient(180deg, #fff 0%, #f6efe9 100%);
    }

    .env-flap{
      position:absolute;
      left:0; right:0;
      top:-10%;
      height:65%;
      background: linear-gradient(180deg, #f0e6df 0%, #e9ddd4 100%);
      clip-path: polygon(0 0, 100% 0, 50% 80%);
      transform-origin: 50% 0%;
      transition: transform .9s ease;
      z-index: 2;
    }

    /* Stamp báº±ng áº£nh */
    .stamp{
      position:absolute;
      right:6%;
      top:10%;
      width: clamp(56px, 10vw, 92px);
      aspect-ratio: 1/1.15;
      border-radius:12px;
      overflow:hidden;
      transform: rotate(7deg);
      box-shadow: 0 8px 18px rgba(0,0,0,0.15);
      user-select:none;
      background:#fff;
      z-index: 3;
    }
    .stamp img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    /* âœ… (1) Khi má»Ÿ thÆ°: dá»i stamp sang pháº£i / lÃªn má»™t chÃºt Ä‘á»ƒ trÃ¡nh chÃ¨n chá»¯ */
    .open .stamp{
      right: 2%;
      top: 6%;
      transform: rotate(7deg);
    }

    .seal{
      position:absolute;
      left:50%;
      top:62%;
      transform: translate(-50%,-50%);
      width: clamp(44px, 8vw, 64px);
      height: clamp(44px, 8vw, 64px);
      border-radius:999px;
      background: radial-gradient(circle at 30% 30%, #ff97aa, #ff4d6d);
      box-shadow: inset 0 0 0 4px rgba(255,255,255,0.55);
      display:grid;
      place-items:center;
      color:#fff;
      font-weight:800;
      user-select:none;
      z-index: 3;
    }

    .letter{
      position:absolute;
      left:6%;
      right:6%;
      bottom:-56%;
      height:82%;
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 12px 30px rgba(0,0,0,0.18);
      padding: clamp(14px, 3vw, 22px);
      text-align:left;
      transition: transform 1s ease;
      overflow:hidden;
      z-index: 1;
    }

    .letterContent{
      height: 100%;
      overflow:auto;
      padding-right: 6px;
      -webkit-overflow-scrolling: touch;
      scroll-behavior: smooth;
    }
    .letterContent::-webkit-scrollbar{ width:8px; }
    .letterContent::-webkit-scrollbar-thumb{
      background: rgba(255,77,109,0.35);
      border-radius: 99px;
    }

    .letter h3{ margin:0 0 8px 0; font-size: clamp(16px, 2.6vw, 20px); }
    .letter p{ margin:0 0 12px 0; font-size: clamp(13px, 2.1vw, 16px); line-height:1.65; }
    .letter .sig{ margin-top: 10px; font-weight:700; }

    .open .env-flap{ transform: rotateX(180deg); }
    .open .letter{ transform: translateY(-58%); }

    #btnContinue{ display:none; }
    .opened #btnContinue{ display:inline-block; }

    .scrollBtns{
      position:absolute;
      right:10px;
      bottom:10px;
      display:flex;
      flex-direction:column;
      gap:8px;
      z-index:5;
    }
    .scrollBtn{
      width: 40px;
      height: 40px;
      border-radius: 999px;
      border: none;
      cursor:pointer;
      background: rgba(255,77,109,0.95);
      color:#fff;
      font-size:18px;
      line-height:40px;
      display:grid;
      place-items:center;
      box-shadow: 0 10px 22px rgba(0,0,0,0.18);
      padding:0;
    }
    .scrollBtn:active{ transform: translateY(1px); }

    .scrollBtns{ opacity:0; transform: translateY(6px); pointer-events:none; transition: .2s ease; }
    .open .scrollBtns{ opacity:1; transform:none; pointer-events:auto; }

    /* Map */
    .mapGrid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: clamp(12px, 2.8vw, 18px);
      align-items:stretch;
      text-align:left;
      margin-top: 10px;
    }
    .mapBox{
      background:#fff;
      border-radius: 16px;
      overflow:hidden;
      box-shadow: 0 10px 26px rgba(0,0,0,0.14);
      min-height: clamp(220px, 40vh, 360px);
    }
    iframe{ width:100%; height:100%; border:0; display:block; }
    .context{
      background: rgba(255,255,255,0.78);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 10px 26px rgba(0,0,0,0.10);
    }
    .context .k{
      font-weight:800;
      margin:0 0 10px 0;
      font-size: clamp(16px, 2.4vw, 20px);
    }
    @media (max-width: 820px){
      .mapGrid{ grid-template-columns: 1fr; }
      .context{ text-align:left; }
    }

    .photo{
      display:block;
      width: clamp(210px, 52vw, 360px);
      max-width:100%;
      height:auto;
      margin: 14px auto 0 auto;
      border-radius: clamp(12px, 2.4vw, 18px);
      box-shadow: 0 10px 26px rgba(0,0,0,0.14);
    }

    @media (prefers-reduced-motion: reduce){
      .heart, .floatImg{ animation:none; opacity:0; }
      .env-flap, .letter{ transition:none; }
      .letterContent{ scroll-behavior:auto; }
    }

    /* ==========================================================
       âœ… Gá»˜P THAY Äá»”I (CHá»T THEO YÃŠU Cáº¦U Má»šI):
       1) TRANG 1: THÆ¯ Má» RA Gáº¦N FULL PHONG BÃŒ
       2) TRANG 2: Ã” CHá»® BÃŠN PHáº¢I ZOOM Lá»šN + CUá»˜N TRONG Ã”
       ========================================================== */

    .envelope{
      width: min(640px, 96vw);
      aspect-ratio: 16/10;
    }

    .letter{
      left: 4.5%;
      right: 4.5%;
      height: 94%;
      bottom: -72%;
      padding: clamp(16px, 3.2vw, 28px);
      border-radius: 16px;
    }

    .open .letter{
      transform: translateY(-86%);
    }

    .letter h3{
      font-size: clamp(18px, 2.8vw, 22px);
    }
    .letter p{
      font-size: clamp(14px, 2.2vw, 17px);
      line-height: 1.78;
    }
    .letterContent{
      padding-right: 10px;
    }

    .mapGrid{
      grid-template-columns: 1fr 1.18fr;
    }

    .mapBox{
      min-height: clamp(260px, 46vh, 420px);
    }

    .context{
      padding: 20px;
    }
    .context .k{
      font-size: clamp(18px, 2.6vw, 22px);
    }

    .context .text{
      font-size: clamp(14px, 2.2vw, 17px);
      line-height: 1.82;
      max-height: clamp(280px, 50vh, 440px);
      overflow: auto;
      padding-right: 10px;
    }
    .context .text::-webkit-scrollbar{ width:8px; }
    .context .text::-webkit-scrollbar-thumb{
      background: rgba(17,17,17,0.18);
      border-radius: 99px;
    }

    @media (max-width: 600px){
      .envelope{ width: 98vw; }
      .open .letter{ transform: translateY(-88%); }
      .context .text{ max-height: 52vh; }
      .open .stamp{ right: 1.5%; top: 5%; }
    }
  </style>
</head>

<body>
  <audio id="bgm" src="music.mp3" preload="auto" loop></audio>

  <div class="stage">

    <!-- SCENE 1 -->
    <section id="sceneEnvelope" class="scene active">
      <div class="panel envelopeWrap" id="envPanel">
        <h1 class="title">ğŸ“¬ A Letter For BÃ© Ká»‹t</h1>
        <p class="text">CÃ³ má»™t lÃ¡ thÆ° nhá» anh muá»‘n dÃ nh cho bÃ© yÃªuuuuu &lt;3.</p>

        <div id="envelope" class="envelope" aria-label="Phong bÃ¬ thÆ°">
          <div class="env-body"></div>
          <div class="env-flap"></div>

          <div class="stamp" aria-label="Love stamp">
            <img src="love stamp.jpg" alt="Love stamp">
          </div>

          <div class="seal">ğŸ’Œ</div>

          <div class="letter">
            <div id="letterContent" class="letterContent">
              <h3>Gá»­i bÃ© Ká»‹t,</h3>
              <p>
                   Váº­y lÃ  mÃ¬nh Ä‘Ã£ Ä‘i cÃ¹ng nhau Ä‘Æ°á»£c 4 thÃ¡ng. Tá»¥i mÃ¬nh Ä‘Ã£ tráº£i qua nhá»¯ng lÃºc vui, cÃ³ lÃºc khÃ´ng
                dá»…, nhÆ°ng Ä‘iá»u tui cháº¯c nháº¥t lÃ  tui váº«n muá»‘n náº¯m tay bÃ© vÃ  cÃ¹ng Ä‘i tiáº¿p Ä‘oáº¡n Ä‘Æ°á»ng tháº­t dÃ i vá» sau.
              </p>

              <p>
                   HÃ´m nay anh viáº¿t lÃ¡ thÆ° nÃ y Ä‘á»ƒ nÃ³i ráº±ng cáº£m Æ¡n vÃ¬ bÃ© Ä‘Ã£ Ä‘áº¿n vá»›i cuá»™c Ä‘á»i anh. Giá»¯a máº¥y chá»¥c
                ngÃ n tháº±ng nerd trong trÆ°á»ng nÃ y thÃ¬ báº±ng má»™t cÃ¡ch ká»³ diá»‡u nÃ o Ä‘Ã³, vÅ© trá»¥ Ä‘Ã£ Ä‘Æ°a tá»¥i mÃ¬nh Ä‘áº¿n vá»›i
                nhau vÃ  xe duyÃªn cho Ä‘Ã´i mÃ¬nh. CÃ³ má»™t cÃ¢u tui Ä‘á»c Ä‘Æ°á»£c trÃªn máº¡ng nhÆ° nÃ y: "Tá»¥i mÃ¬nh Ä‘Ã£ lÃ m Ä‘Æ°á»£c viá»‡c
                khÃ³ nháº¥t Ä‘Ã³ chÃ­nh lÃ  tÃ¬m tháº¥y nhau giá»¯a tháº¿ giá»›i 7 tá»· ngÆ°á»i nÃ y, bÃ¢y giá» viá»‡c dá»… nháº¥t chÃ­nh lÃ  giá»¯ 
                láº¥y nhau thÃ´i" vÃ  tá»¥i mÃ¬nh sáº½ lÃ m Ä‘Æ°á»£c mÃ  nhá»‰, Ä‘Ãºng khÃ´ng bÃ©?
              </p>

              <p>
                  á» bÃ©, anh thÃ­ch cÃ¡ch bÃ© suy nghÄ©, cÃ¡ch bÃ© luÃ´n tá»± tin, cÃ¡ch bÃ© cÆ°á»i, cÃ¡ch bÃ© nhÃ¬n tui Ä‘Ã´i khi, cÃ¡ch bÃ© dÃ¹ng hÃ nh Ä‘á»™ng Ä‘á»ƒ
                nÃ³i nÃªn lá»i yÃªu, thÃ­ch cáº£ nhá»¯ng cÃ¡i Ã´m, nhá»¯ng trÃ² Ä‘Ã¹a, nhá»¯ng cÃ¡i hÃ´n quÃ½ giÃ¡ vÃ  cáº£ nhá»¯ng láº§n tá»¥i mÃ¬nh Ä‘i date tháº­t
                lÃ  free will, thÃ­ch nhá»¯ng sá»± quan tÃ¢m bÃ© dÃ nh cho tui, nhá»¯ng sá»± cá»‘ gáº¯ng cho má»‘i quan há»‡ cá»§a tá»¥i mÃ¬nh,
                thÃ­ch cÃ¡ch báº¡n chÆ¡i game vá»¥ng vá» mÃ  váº«n kiÃªn nháº«n chÆ¡i vá»›i tui, thÃ­ch mÃ¹i thÆ¡m nÆ¡i tÃ³c bÃ© khi tui Ä‘Æ°á»£c Ã´m,
                thÃ­ch cÃ¡ch bÃ© trÃ´ng tháº­t tá»a sÃ¡ng trong náº¯ng (xin lá»—i vÃ¬ skill chá»¥p áº£nh cá»§a tui khÃ´ng Ä‘á»§ Ä‘á»ƒ chá»©ng minh cÃ¡i quan Ä‘iá»ƒm nÃ y),
                thÃ­ch viá»‡c bÃ© cho tui Ä‘á»§ sá»± tin tÆ°á»Ÿng trong 1 má»‘i quan há»‡, thÃ­ch cÃ¡ch bÃ© luÃ´n quan tÃ¢m Ä‘áº¿n tui, thÃ­ch "bá»‹ Ä‘Ã¡nh",
                thÃ­ch nhá»¯ng gÃ¬ báº¡n Ä‘ang nhÃ¬n nháº­n vÃ  hÆ°á»›ng Ä‘áº¿n trong má»‘i quan há»‡ cá»§a tá»¥i mÃ¬nh, thÃ­ch cÃ¡i chiá»u cao cá»§a báº¡n ná»¯a, Ã  vÃ 
                thÃ­ch sá»± quan tÃ¢m vÃ  tá»­ táº¿ báº¡n dÃ nh cho má»i ngÆ°á»i xung quanh mÃ¬nh ná»¯a. Nhiá»u nhiá»u nhiá»u láº¯m bÃ© Æ¡i! YÃªu bÃ©, tui
                biáº¿t tui sai khi nÃ³i yÃªu 1 ngÆ°á»i pháº£i cáº§n cÃ³ lÃ½ do chá»©, nhÆ°ng mÃ , bÃ¢y giá» vá»›i tui bÃ© chÃ­nh lÃ  lÃ½ do, vÃ¬ bÃ© lÃ  bÃ© vÃ  tui yÃªu bÃ© ráº¥t nhiá»u.
              
                CÃ³ nhá»¯ng ngÃ y má»‡t, chá»‰ cáº§n nhÃ¬n tháº¥y bÃ© anh Ä‘Ã£ cáº£m tháº¥y vui váº», chá»‰ cáº§n nghe bÃ© nÃ³i vÃ i cÃ¢u lÃ  anh tháº¥y bÃ¬nh yÃªn hÆ¡n, chá»‰ cáº§n Ä‘Æ°á»£c Ã´m em lÃ  anh cáº£m tháº¿ giá»›i nÃ y tháº­t im áº¯ng Ä‘áº¿n láº¡,
                chá»‰ cáº§n Ä‘Æ°á»£c hÃ´n bÃ©, vá»‹ ngá»t nÆ¡i Ä‘áº§u mÃ´i khiáº¿n má»i Ä‘áº¯ng cay trÃªn tháº¿ giá»›i nÃ y Ä‘á»u dá»‹u láº¡i.. Tháº¿ giá»›i cá»§a tháº±ng ThÃ nh nÃ y trá»Ÿ nÃªn tháº­t yÃªn bÃ¬nh tá»« khi cÃ³ bÃ© Ä‘áº¿n, dÃ¹ hay Ä‘Æ°á»£c bÃ© cáº¯n
                yÃªu, bÃ¡u yÃªu vÃ  Ä‘áº¥m yÃªu kakaka.
              </p>

              <p>
                DÃ¹ tá»¥i mÃ¬nh Ä‘Ã£ cÃ³ nhiá»u sá»± buá»“n bá»±c, má»‡t má»i trong thá»i gian dáº¡o gáº§n Ä‘Ã¢y, tui váº«n muá»‘n há»c cÃ¡ch yÃªu bÃ© Ä‘Ãºng hÆ¡n,
                kiÃªn nháº«n hÆ¡n vÃ  tá»­ táº¿ hÆ¡n. BÃ© hÃ£y cho tui biáº¿t bÃ© Ä‘ang cáº£m tháº¥y sao, cáº§n gÃ¬ vÃ  muá»‘n gÃ¬ nhÃ©. NgÆ°á»£c láº¡i, tui cÅ©ng
                sáº½ há»c cÃ¡ch Ä‘á»ƒ nÃ³i ra suy nghÄ© cá»§a mÃ¬nh, nÃ³i ra mong muá»‘n cá»§a tá»¥i mÃ¬nh Ä‘á»ƒ mÃ¬nh hiá»ƒu nhau hÆ¡n vÃ  tá»¥i mÃ¬nh sáº½ Ä‘Æ°á»£c lÃ 
                báº£n thÃ¢n trong má»‘i quan há»‡ nÃ y nhÃ©.
              </p>

              <p>
                VÃ  náº¿u bÃ© Æ¡i, anh cÅ©ng muá»‘n mÃ¬nh cÃ³ thÃªm tháº­t nhiá»u ká»· niá»‡m má»›i,
                Ä‘á»ƒ sau nÃ y nhÃ¬n láº¡i sáº½ tháº¥y â€œÃ , hoÃ¡ ra tá»¥i mÃ¬nh Ä‘Ã£ cá»‘ gáº¯ng vÃ¬ nhau nhiá»u nhÆ° váº­y vÃ  Ä‘á»‘i phÆ°Æ¡ng lÃ  ngÆ°á»i xá»©ng Ä‘Ã¡ng
                Ä‘á»ƒ mÃ¬nh cho Ä‘i nhiá»u Ä‘áº¿n váº­y.â€ DÃ¹ yÃªu gáº§n hay yÃªu xa, tui cÅ©ng muá»‘n Ä‘Æ°á»£c tráº£i qua cÃ¹ng bÃ©, tui muá»‘n tuá»•i tráº»
                cá»§a mÃ¬nh sáº½ cÃ³ em bÃªn Ä‘á»i, sáº½ cÃ³ nhiá»u ká»· niá»‡m cÃ¹ng bÃ© vÃ  tá»¥i mÃ¬nh sáº½ tráº£i qua nhá»¯ng nÄƒm 20 nÃ y tháº­t lÃ  vui váº» nhÃ©.
                Náº¿u bÃ© Ä‘á»“ng Ã½ cho tui cÆ¡ há»™i, Ä‘á»“ng Ã½ bÆ°á»›c tiáº¿p vá»›i tui thÃ¬ áº¥n next nhÃ©. YÃªu em. KhÃ´ng áº¥n tui giáº­n!
              </p>

              <p class="sig">â€” YÃªu em, ThÃ nh.</p>
              <div style="height:10px"></div>
            </div>

            <div class="scrollBtns" aria-label="NÃºt cuá»™n thÆ°">
              <button id="btnScrollDown" class="scrollBtn" title="Cuá»™n xuá»‘ng">â†“</button>
              <button id="btnScrollUp" class="scrollBtn" title="Cuá»™n lÃªn">â†‘</button>
            </div>
          </div>
        </div>

        <div class="btnRow">
          <button id="btnOpen">Má»Ÿ thÆ° âœ‰ï¸</button>
          <button id="btnContinue" class="btnGhost">Äá»c xong rá»“i ğŸ‘‰</button>
        </div>
      </div>
    </section>

    <!-- SCENE 2 -->
    <section id="sceneAsk" class="scene">
      <div class="panel">
        <h2 class="subtitle">BÃ© Ká»‹t cÃ³ Ä‘á»“ng Ã½ lÃ m Valentine cá»§a anh khÃ´ng? ğŸ’–</h2>
        <p class="text">KhÃ´ng chá»‰ nÄƒm nay.. mÃ  náº¿u bÃ© cho phÃ©p, cáº£ nhá»¯ng nÄƒm sau vÃ  nÄƒm sau vÃ  nÄƒm sau sau ná»¯a nhÃ©.</p>
        <div class="btnRow">
          <button id="btnYes">Äá»“ng Ã½ âœ…</button>
          <button id="btnNo" class="btnGhost">Äá»ƒ bÃ© suy nghÄ© thÃªm ğŸ˜³</button>
        </div>
        <p id="noHint" class="text" style="display:none; margin-top:12px;">
          Ai choooooooo, tui biáº¿t lÃ  em sáº½ nháº¥n vÃ´ nÃºt nÃ y trÆ°á»›c! Quay láº¡i vÃ  áº¥n Ä‘á»“ng Ã½ cho tÃ´i - ny Ä‘ang dá»±n cá»§a em -
        </p>
      </div>
    </section>

    <!-- SCENE 3 -->
    <section id="sceneMap" class="scene">
      <div class="panel">
        <h2 class="subtitle">NÆ¡i mÃ¬nh gáº·p nhau láº§n Ä‘áº§u ğŸ“</h2>
        <p class="text">Báº£n Ä‘á»“ á»Ÿ Ä‘Ã¢y, cÃ²n cÃ¢u chuyá»‡n thÃ¬ tui Ä‘á»ƒ ngay bÃªn cáº¡nh.</p>

        <div class="mapGrid">
          <div class="mapBox">
            <iframe
              id="mapFrame"
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3919.5115795957554!2d106.65532687435655!3d10.77207498937643!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x31752ec3c161a3fb%3A0xef77cd47a1cc691e!2sHCMC%20University%20of%20Technology%20(HCMUT)!5e0!3m2!1sen!2s!4v1770971711669!5m2!1sen!2s"
              title="Báº£n Ä‘á»“ nÆ¡i gáº·p nhau láº§n Ä‘áº§u">
            </iframe>
          </div>

          <div class="context">
            <p class="k">Chuyá»‡n cá»§a tá»¥i mÃ¬nh</p>
            <p class="text" style="margin:0;">
              Tui váº«n nhá»› quÃ i cÃ¡i khoáº£nh kháº¯c Ä‘Ã³, cÃ¡i giÃ¢y phÃºt láº§n Ä‘áº§u tiÃªn tui nhÃ¬n tháº¥y em á»Ÿ tÃ²a C4. 
              Em trÃ´ng tháº­t ráº¡ng rá»¡ dÆ°á»›i Ã¡nh náº¯ng bÃªn khung cá»­a sá»• Ä‘Ã³. Ãnh náº¯ng lÃ m tÃ³c em thÃªm vÃ ng, Ä‘Ã´i mÃ´i
              cá»§a em nhÆ° mang theo ma lá»±c lÃ m ngÆ°á»i khÃ¡c Ä‘áº¯m chÃ¬m vÃ  em chá»‰ cáº§n Ä‘á»©ng Ä‘Ã³ thÃ´i, cáº£ tháº¿ giá»›i cá»§a tui
              Ä‘Ã£ dá»«ng láº¡i trong khoáº£nh kháº¯c Ä‘Ã³ rá»“i. Tui biáº¿t tui bá»‹ em thu hÃºt rá»“i. Nhá»¯ng ngÃ y sau Ä‘Ã³, tui cá»© lÃ©n
              nhÃ¬n em trong lá»›p hoÃ i, kiáº¿m cá»› Ä‘á»ƒ ngÃ³ ngang ngÃ³ dá»c Ä‘á»ƒ Ä‘Æ°á»£c nhÃ¬n tháº¥y em má»™t chÃºt. LÃºc Ä‘Ã³ em khÃ´ng
              biáº¿t Ä‘Ã¢u bÃ©, tui nhÆ° con láº­t Ä‘áº­t váº­y Ã¡, haha nghÄ© láº¡i mÃ  tháº¥y ngÆ°á»£ng. LÃºc nhÃ³m tui lÃªn thuyáº¿t trÃ¬nh, 
              tui cÅ©ng lÃ©n nhÃ¬n em. CÃ³ lÃºc Ä‘ang á»Ÿ trÃªn Ä‘Ã³ mÃ  tháº¥y em nhÃ¬n lÃªn chá»— nhÃ³m tui, tim tui khá»±ng láº¡i vÃ i 
              nhá»‹p, nÃ³ biáº¿t tui Ä‘ang nhÃ¬n ngÆ°á»i mÃ  sau nÃ y mÃ¬nh sáº½ thÆ°Æ¡ng ráº¥t nhiá»u. VÃ  rá»“i dÆ°á»›i gá»‘c cÃ¢y hoa sá»©, 
              tui Ä‘Ã£ Ä‘Æ°á»£c gáº·p em vÃ  tiáº¿p thÃªm can Ä‘áº£m Ä‘á»ƒ báº¯t chuyá»‡n lÃ m quen. Sau táº¥t cáº£, dÃ¹ sau nÃ y tui cÃ³ máº¥t háº¿t
              kÃ½ á»©c vá» thá»i Ä‘áº¡i há»c thÃ¬ khoáº£ng thá»i gian nÃ y vÃ  khoáº£ng thá»i gian sau nÃ y vá»›i bÃ© sáº½ lÃ  thá»© tui giá»¯ 
              láº¡i cuá»‘i cÃ¹ng cho báº£n thÃ¢n mÃ¬nh. Cáº£m Æ¡n bÃ© vÃ¬ Ä‘Ã£ Ä‘á»c Ä‘áº¿n Ä‘Ã¢y, lÃºc Ä‘ang viáº¿t nhá»¯ng dÃ²ng nÃ y, tui báº¥t
              giÃ¡c nhá»› láº¡i khoáº£ng thá»i gian khi mÃ¬nh bÃªn nhau áº¥y vÃ  tui cáº£m tháº¥y ráº¥t vui, tui cáº£m Æ¡n Ä‘á»‹nh má»‡nh, vÅ© 
              trá»¥, cupid hay báº¥t cá»© thá»© gÃ¬ Ä‘Ã³ Ä‘Ã£ Ä‘Æ°a em Ä‘áº¿n vá»›i tui. Tui sáº½ luÃ´n trÃ¢n trá»n em, trÃ¢n trá»ng khoáº£ng 
              thá»i gian nÃ y vÃ  trÃ¢n trá»ng tÃ¬nh yÃªu cá»§a tá»¥i mÃ¬nh. 
              Káº¿t chuyá»‡n, tui mong ráº±ng láº§n Ä‘áº§u tiÃªn tui tháº¥y em, em diá»‡n cho mÃ¬nh bá»™ Ä‘á»“ tráº¯ng
              cá»§a trÆ°á»ng bÃ¡ch khoa thÃ¬ sau nÃ y cÅ©ng sáº½ Ä‘Æ°á»£c tháº¥y em trong chiáº¿c vÃ¡y cÆ°á»›i mÃ u tráº¯ng tinh nhÃ©. Lttyvkma.
              <br><br>
              VÃ  hÃ£y Ä‘Ã¡nh dáº¥u tháº­t nhiá»u Ä‘iá»ƒm trÃªn báº£n Ä‘á»“ cÃ¹ng nhau trong hÃ nh trÃ¬nh cá»§a tá»¥i mÃ¬nh nha bÃ©
            </p>
            <div class="btnRow" style="justify-content:flex-start; margin-top:14px;">
              <button id="btnToFinal"> Lets gooo ğŸ‘‰</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- SCENE 4 -->
    <section id="sceneFinal" class="scene">
      <div class="panel" id="finalCard">
        <h2 class="subtitle">Happy Valentine â¤ï¸</h2>
        <p class="text">
          Anh thÆ°Æ¡ng bÃ© Ká»‹t ráº¥t nhiá»u. <br>
          Cáº£m Æ¡n vÃ¬ Ä‘Ã£ Ä‘á»“ng hÃ nh cÃ¹ng anh nha bÃ© vÃ  tá»¥i mÃ¬nh
          hÃ£y Ä‘á»“ng hÃ nh cÃ¹ng nhau lÃ¢u tháº­t lÃ  lÃ¢u nha bÃ©. ThÆ°Æ¡ng em.
        </p>
        <img class="photo" src="áº£nh Ä‘Ã´i.jpg" alt="áº¢nh Ä‘Ã´i">
      </div>
    </section>

  </div>

  <script>
    const $ = (id) => document.getElementById(id);
    const sceneEnvelope = $("sceneEnvelope");
    const sceneAsk = $("sceneAsk");
    const sceneMap = $("sceneMap");
    const sceneFinal = $("sceneFinal");
    const envelope = $("envelope");
    const bgm = $("bgm");
    const envPanel = $("envPanel");
    const letterContent = $("letterContent");

    function showScene(scene){
      for (const s of [sceneEnvelope, sceneAsk, sceneMap, sceneFinal]) s.classList.remove("active");
      scene.classList.add("active");
    }

    async function tryPlayMusic(){
      try{
        bgm.volume = 0.85;
        await bgm.play();
      }catch(e){
        console.log("Autoplay blocked:", e);
      }
    }

    function rand(min, max){ return Math.random() * (max - min) + min; }

    function getNoSpawnZone(){
      const activePanel = document.querySelector(".scene.active .panel");
      const r = activePanel.getBoundingClientRect();
      const pad = Math.max(16, Math.round(Math.min(innerWidth, innerHeight) * 0.05));
      return { left:r.left-pad, right:r.right+pad, top:r.top-pad, bottom:r.bottom+pad };
    }

    function pickSpawnPoint(){
      const z = getNoSpawnZone();
      const W = innerWidth, H = innerHeight;
      for(let i=0;i<14;i++){
        const x = rand(0, W);
        const y = rand(0, H);
        const inside = (x>=z.left && x<=z.right && y>=z.top && y<=z.bottom);
        if(!inside) return {x,y};
      }
      return {x: rand(0,W), y: rand(0,40)};
    }

    function spawnHeart(){
      const {x,y} = pickSpawnPoint();
      const heart = document.createElement("div");
      heart.className = "heart";
      heart.textContent = "â¤ï¸";

      const minSize = Math.max(16, Math.min(innerWidth, innerHeight) * 0.028);
      const maxSize = Math.max(26, Math.min(innerWidth, innerHeight) * 0.052);
      heart.style.fontSize = rand(minSize, maxSize) + "px";

      heart.style.left = x + "px";
      heart.style.top  = y + "px";

      const drift = rand(-50, 50);
      heart.style.setProperty("--x0", "0px");
      heart.style.setProperty("--x1", drift + "px");

      const isMobile = matchMedia("(max-width: 600px)").matches;
      const duration = isMobile ? rand(5.8, 7.8) : rand(6.2, 9.2);
      heart.style.animationDuration = duration + "s";

      document.body.appendChild(heart);
      setTimeout(() => heart.remove(), duration * 1000 + 200);
    }

    const isMobile = matchMedia("(max-width: 600px)").matches;
    setInterval(spawnHeart, isMobile ? 650 : 450);

    /* âœ… (2) Sau khi má»Ÿ thÆ°: thÃªm 3 áº£nh ná»n bay lÆ¡ lá»­ng */
    let bgSpawned = false;

    function createFloatingBgImage(src, index){
      const img = document.createElement("img");
      img.className = "floatImg";
      img.src = src;
      img.alt = "Floating background " + (index + 1);

      // KÃ­ch thÆ°á»›c áº£nh: nháº¹ nhÃ ng, khÃ´ng láº¥n panel
      const base = Math.min(innerWidth, innerHeight);
      const wMin = Math.max(90, base * 0.16);
      const wMax = Math.max(140, base * 0.24);
      img.style.width = rand(wMin, wMax) + "px";
      img.style.height = "auto";

      // TrÃ¡nh Ä‘Ã¨ panel
      const {x} = pickSpawnPoint();
      img.style.left = x + "px";
      img.style.top = rand(0, innerHeight * 0.35) + "px";

      // Drift + rotate
      const drift = rand(-140, 140);
      img.style.setProperty("--x0", "0px");
      img.style.setProperty("--x1", drift + "px");
      img.style.setProperty("--r0", rand(-10, 10) + "deg");
      img.style.setProperty("--r1", rand(-18, 18) + "deg");

      // Animation
      const dur = isMobile ? rand(18, 26) : rand(20, 30);
      img.style.animationDuration = dur + "s";
      img.style.animationDelay = (index * 1.6) + "s";

      document.body.appendChild(img);
    }

    function spawnBgImagesOnce(){
      if(bgSpawned) return;
      bgSpawned = true;

      const files = ["background 1.jpg", "background 2.jpg", "background 3.jpg"];
      files.forEach((f, i) => createFloatingBgImage(f, i));
    }

    // ===== Flow =====
    $("btnOpen").addEventListener("click", async () => {
      envelope.classList.add("open");
      envPanel.classList.add("opened");
      await tryPlayMusic();

      if(letterContent) letterContent.scrollTop = 0;

      // âœ… (2) má»Ÿ thÆ° xong thÃ¬ báº­t 3 áº£nh ná»n bay
      spawnBgImagesOnce();
    });

    $("btnContinue").addEventListener("click", () => {
      showScene(sceneAsk);
    });

    $("btnNo").addEventListener("click", () => {
      $("noHint").style.display = "block";
    });

    $("btnYes").addEventListener("click", () => {
      showScene(sceneMap);
    });

    $("btnToFinal").addEventListener("click", () => {
      showScene(sceneFinal);
    });

    function scrollLetter(delta){
      if(!letterContent) return;
      letterContent.scrollBy({ top: delta, behavior: "smooth" });
    }

    $("btnScrollDown").addEventListener("click", () => scrollLetter(220));
    $("btnScrollUp").addEventListener("click", () => scrollLetter(-220));

    function updateScrollButtons(){
      if(!letterContent) return;
      const up = $("btnScrollUp");
      const down = $("btnScrollDown");
      const atTop = letterContent.scrollTop <= 2;
      const atBottom = letterContent.scrollTop + letterContent.clientHeight >= letterContent.scrollHeight - 2;

      up.style.opacity = atTop ? 0.35 : 1;
      down.style.opacity = atBottom ? 0.35 : 1;
    }
    if(letterContent){
      letterContent.addEventListener("scroll", updateScrollButtons);
      updateScrollButtons();
    }
  </script>
</body>
</html>
