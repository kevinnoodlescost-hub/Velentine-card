<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Thi·ªáp Valentine</title>

  <style>
    :root{
      --bg1:#ff9a9e;
      --bg2:#fad0c4;
      --cardW: min(860px, calc(100vw - 28px));
      --radius: clamp(14px, 2.8vw, 22px);
      --pad: clamp(16px, 3.8vw, 36px);
      --h1: clamp(22px, 3.6vw, 36px);
      --h2: clamp(18px, 3vw, 28px);
      --p:  clamp(14px, 2.1vw, 18px);
      --btn: clamp(14px, 2.1vw, 16px);
      --shadow: 0 12px 34px rgba(0,0,0,0.22);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: "Segoe UI", sans-serif;
      background: linear-gradient(135deg,var(--bg1),var(--bg2));
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      text-align:center;
    }

    /* Tim n·ªÅn */
    .heart{
      position:fixed;
      z-index:1;
      pointer-events:none;
      opacity:0;
      will-change:transform, opacity;
      animation: floatUp linear forwards;
      filter: drop-shadow(0 4px 10px rgba(0,0,0,0.18));
    }
    @keyframes floatUp{
      0%   { transform: translate(var(--x0), 110vh) rotate(0deg); opacity:0; }
      12%  { opacity:1; }
      100% { transform: translate(var(--x1), -20vh) rotate(360deg); opacity:0; }
    }

    .stage{ position:relative; z-index:3; width:var(--cardW); }

    .panel{
      background:#fff;
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      padding:var(--pad);
      margin: 0 auto;
    }

    .title{ font-size:var(--h1); margin:0 0 10px 0; line-height:1.15; }
    .subtitle{ font-size:var(--h2); margin:0 0 12px 0; line-height:1.25; }
    .text{ font-size:var(--p); line-height:1.7; margin:0 0 14px 0; }

    .btnRow{
      display:flex;
      gap:12px;
      justify-content:center;
      flex-wrap:wrap;
      margin-top: 12px;
    }

    button{
      border:none;
      border-radius:999px;
      padding: clamp(10px, 2.5vw, 12px) clamp(16px, 4.2vw, 26px);
      font-size:var(--btn);
      cursor:pointer;
      color:#fff;
      background:#ff4d6d;
      transition: transform .08s ease, opacity .2s ease;
    }
    button:hover{ opacity:.92; }
    button:active{ transform: translateY(1px); }

    .btnGhost{ background:#111; opacity:.85; }

    .scene{ display:none; }
    .scene.active{ display:block; }

    /* ===== Envelope ===== */
    .envelopeWrap{
      display:grid;
      place-items:center;
      gap:16px;
    }

    .envelope{
      width: min(520px, 92vw);
      aspect-ratio: 16/10;
      position:relative;
      border-radius:18px;
      background: #f7f2ee;
      box-shadow: 0 10px 26px rgba(0,0,0,0.18);
      overflow:hidden;
    }

    .env-body{
      position:absolute; inset:0;
      background: linear-gradient(180deg, #fff 0%, #f6efe9 100%);
    }

    .env-flap{
      position:absolute;
      left:0; right:0;
      top:-10%;
      height:65%;
      background: linear-gradient(180deg, #f0e6df 0%, #e9ddd4 100%);
      clip-path: polygon(0 0, 100% 0, 50% 80%);
      transform-origin: 50% 0%;
      transition: transform .9s ease;
      z-index: 2;
    }

    /* Stamp b·∫±ng ·∫£nh */
    .stamp{
      position:absolute;
      right:6%;
      top:10%;
      width: clamp(56px, 10vw, 92px);
      aspect-ratio: 1/1.15;
      border-radius:12px;
      overflow:hidden;
      transform: rotate(7deg);
      box-shadow: 0 8px 18px rgba(0,0,0,0.15);
      user-select:none;
      background:#fff;
      z-index: 3;
    }
    .stamp img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    .seal{
      position:absolute;
      left:50%;
      top:62%;
      transform: translate(-50%,-50%);
      width: clamp(44px, 8vw, 64px);
      height: clamp(44px, 8vw, 64px);
      border-radius:999px;
      background: radial-gradient(circle at 30% 30%, #ff97aa, #ff4d6d);
      box-shadow: inset 0 0 0 4px rgba(255,255,255,0.55);
      display:grid;
      place-items:center;
      color:#fff;
      font-weight:800;
      user-select:none;
      z-index: 3;
    }

    .letter{
      position:absolute;
      left:6%;
      right:6%;
      bottom:-56%;
      height:82%;
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 12px 30px rgba(0,0,0,0.18);
      padding: clamp(14px, 3vw, 22px);
      text-align:left;
      transition: transform 1s ease;
      overflow:hidden; /* ƒë·ªÉ n√∫t cu·ªôn n·∫±m g·ªçn trong th∆∞ */
      z-index: 1;
    }

    /* Khung cu·ªôn n·ªôi dung b√™n trong th∆∞ */
    .letterContent{
      height: 100%;
      overflow:auto;
      padding-right: 6px;
      -webkit-overflow-scrolling: touch;
      scroll-behavior: smooth;
    }
    .letterContent::-webkit-scrollbar{ width:8px; }
    .letterContent::-webkit-scrollbar-thumb{
      background: rgba(255,77,109,0.35);
      border-radius: 99px;
    }

    .letter h3{ margin:0 0 8px 0; font-size: clamp(16px, 2.6vw, 20px); }
    .letter p{ margin:0 0 12px 0; font-size: clamp(13px, 2.1vw, 16px); line-height:1.65; }
    .letter .sig{ margin-top: 10px; font-weight:700; }

    .open .env-flap{ transform: rotateX(180deg); }
    .open .letter{ transform: translateY(-58%); }

    /* N√∫t xu·∫•t hi·ªán sau khi m·ªü th∆∞ */
    #btnContinue{ display:none; }
    .opened #btnContinue{ display:inline-block; }

    /* N√∫t cu·ªôn trong th∆∞ */
    .scrollBtns{
      position:absolute;
      right:10px;
      bottom:10px;
      display:flex;
      flex-direction:column;
      gap:8px;
      z-index:5;
    }
    .scrollBtn{
      width: 40px;
      height: 40px;
      border-radius: 999px;
      border: none;
      cursor:pointer;
      background: rgba(255,77,109,0.95);
      color:#fff;
      font-size:18px;
      line-height:40px;
      display:grid;
      place-items:center;
      box-shadow: 0 10px 22px rgba(0,0,0,0.18);
      padding:0;
    }
    .scrollBtn:active{ transform: translateY(1px); }

    /* ·∫®n n√∫t khi ch∆∞a m·ªü th∆∞ */
    .scrollBtns{ opacity:0; transform: translateY(6px); pointer-events:none; transition: .2s ease; }
    .open .scrollBtns{ opacity:1; transform:none; pointer-events:auto; }

    /* Map */
    .mapGrid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: clamp(12px, 2.8vw, 18px);
      align-items:stretch;
      text-align:left;
      margin-top: 10px;
    }
    .mapBox{
      background:#fff;
      border-radius: 16px;
      overflow:hidden;
      box-shadow: 0 10px 26px rgba(0,0,0,0.14);
      min-height: clamp(220px, 40vh, 360px);
    }
    iframe{ width:100%; height:100%; border:0; display:block; }
    .context{
      background: rgba(255,255,255,0.78);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 10px 26px rgba(0,0,0,0.10);
    }
    .context .k{
      font-weight:800;
      margin:0 0 10px 0;
      font-size: clamp(16px, 2.4vw, 20px);
    }
    @media (max-width: 820px){
      .mapGrid{ grid-template-columns: 1fr; }
      .context{ text-align:left; }
    }

    .photo{
      display:block;
      width: clamp(210px, 52vw, 360px);
      max-width:100%;
      height:auto;
      margin: 14px auto 0 auto;
      border-radius: clamp(12px, 2.4vw, 18px);
      box-shadow: 0 10px 26px rgba(0,0,0,0.14);
    }

    @media (prefers-reduced-motion: reduce){
      .heart{ animation:none; opacity:0; }
      .env-flap, .letter{ transition:none; }
      .letterContent{ scroll-behavior:auto; }
    }

    /* ==========================================================
       ‚úÖ G·ªòP THAY ƒê·ªîI (CH·ªêT THEO Y√äU C·∫¶U M·ªöI):
       1) TRANG 1: TH∆Ø M·ªû RA G·∫¶N FULL PHONG B√å
       2) TRANG 2: √î CH·ªÆ B√äN PH·∫¢I ZOOM L·ªöN + CU·ªòN TRONG √î
       ========================================================== */

    /* ===== TRANG 1: ENVELOPE L·ªöN H∆†N ===== */
    .envelope{
      width: min(640px, 96vw);
      aspect-ratio: 16/10;
    }

    /* ===== TRANG 1: L√Å TH∆Ø G·∫¶N FULL PHONG B√å =====
       - height tƒÉng m·∫°nh
       - bottom √¢m h∆°n ƒë·ªÉ khi ƒë√≥ng v·∫´n n·∫±m g·ªçn
       - khi open: k√©o l√™n nhi·ªÅu h∆°n ƒë·ªÉ nh√¨n g·∫ßn full */
    .letter{
      left: 4.5%;
      right: 4.5%;
      height: 94%;                 /* g·∫ßn full */
      bottom: -72%;                /* gi·∫•u s√¢u h∆°n khi ch∆∞a m·ªü */
      padding: clamp(16px, 3.2vw, 28px);
      border-radius: 16px;
    }

    .open .letter{
      transform: translateY(-86%); /* m·ªü ra chi·∫øm g·∫ßn full phong b√¨ */
    }

    /* D·ªÖ ƒë·ªçc h∆°n trong th∆∞ */
    .letter h3{
      font-size: clamp(18px, 2.8vw, 22px);
    }
    .letter p{
      font-size: clamp(14px, 2.2vw, 17px);
      line-height: 1.78;
    }
    .letterContent{
      padding-right: 10px;
    }

    /* ===== TRANG 2: ZOOM √î CH·ªÆ B√äN PH·∫¢I + CU·ªòN TRONG √î ===== */
    .mapGrid{
      grid-template-columns: 1fr 1.18fr; /* √¥ ch·ªØ b·ª± h∆°n c·ªôt map */
    }

    .mapBox{
      min-height: clamp(260px, 46vh, 420px);
    }

    .context{
      padding: 20px;
    }
    .context .k{
      font-size: clamp(18px, 2.6vw, 22px);
    }

    /* Gi·ªØ cu·ªôn trong √¥ (ƒë√∫ng √Ω b·∫°n) + hi·ªÉn th·ªã nhi·ªÅu h∆°n tr∆∞·ªõc */
    .context .text{
      font-size: clamp(14px, 2.2vw, 17px);
      line-height: 1.82;
      max-height: clamp(280px, 50vh, 440px);
      overflow: auto;
      padding-right: 10px;
    }
    .context .text::-webkit-scrollbar{ width:8px; }
    .context .text::-webkit-scrollbar-thumb{
      background: rgba(17,17,17,0.18);
      border-radius: 99px;
    }

    /* Mobile t·ªëi ∆∞u */
    @media (max-width: 600px){
      .envelope{ width: 98vw; }
      .open .letter{ transform: translateY(-88%); }
      .context .text{ max-height: 52vh; }
    }
  </style>
</head>

<body>
  <audio id="bgm" src="music.mp3" preload="auto" loop></audio>

  <div class="stage">

    <!-- SCENE 1 -->
    <section id="sceneEnvelope" class="scene active">
      <div class="panel envelopeWrap" id="envPanel">
        <h1 class="title">üì¨ A Letter For B√© K·ªãt</h1>
        <p class="text">C√≥ m·ªôt l√° th∆∞ nh·ªè anh mu·ªën d√†nh cho b√© y√™uuuuu &lt;3.</p>

        <div id="envelope" class="envelope" aria-label="Phong b√¨ th∆∞">
          <div class="env-body"></div>
          <div class="env-flap"></div>

          <div class="stamp" aria-label="Love stamp">
            <img src="love stamp.jpg" alt="Love stamp">
          </div>

          <div class="seal">üíå</div>

          <div class="letter">
            <div id="letterContent" class="letterContent">
              <h3>G·ª≠i b√© K·ªãt,</h3>
              <p>
                   V·∫≠y l√† m√¨nh ƒë√£ ƒëi c√πng nhau ƒë∆∞·ª£c 4 th√°ng. T·ª•i m√¨nh ƒë√£ tr·∫£i qua nh·ªØng l√∫c vui, c√≥ l√∫c kh√¥ng
                d·ªÖ, nh∆∞ng ƒëi·ªÅu tui ch·∫Øc nh·∫•t l√† tui v·∫´n mu·ªën n·∫Øm tay b√© v√† c√πng ƒëi ti·∫øp ƒëo·∫°n ƒë∆∞·ªùng th·∫≠t d√†i v·ªÅ sau.
              </p>

              <p>
                   H√¥m nay anh vi·∫øt l√° th∆∞ n√†y ƒë·ªÉ n√≥i r·∫±ng c·∫£m ∆°n v√¨ b√© ƒë√£ ƒë·∫øn v·ªõi cu·ªôc ƒë·ªùi anh. Gi·ªØa m·∫•y ch·ª•c
                ng√†n th·∫±ng nerd trong tr∆∞·ªùng n√†y th√¨ b·∫±ng m·ªôt c√°ch k·ª≥ di·ªáu n√†o ƒë√≥, v≈© tr·ª• ƒë√£ ƒë∆∞a t·ª•i m√¨nh ƒë·∫øn v·ªõi
                nhau v√† xe duy√™n cho ƒë√¥i m√¨nh. C√≥ m·ªôt c√¢u tui ƒë·ªçc ƒë∆∞·ª£c tr√™n m·∫°ng nh∆∞ n√†y: "T·ª•i m√¨nh ƒë√£ l√†m ƒë∆∞·ª£c vi·ªác
                kh√≥ nh·∫•t ƒë√≥ ch√≠nh l√† t√¨m th·∫•y nhau gi·ªØa th·∫ø gi·ªõi 7 t·ª∑ ng∆∞·ªùi n√†y, b√¢y gi·ªù vi·ªác d·ªÖ nh·∫•t ch√≠nh l√† gi·ªØ 
                l·∫•y nhau th√¥i" v√† t·ª•i m√¨nh s·∫Ω l√†m ƒë∆∞·ª£c m√† nh·ªâ, ƒë√∫ng kh√¥ng b√©?
              </p>

              <p>
                  ·ªû b√©, anh th√≠ch c√°ch b√© suy nghƒ©, c√°ch b√© lu√¥n t·ª± tin, c√°ch b√© c∆∞·ªùi, c√°ch b√© nh√¨n tui ƒë√¥i khi, c√°ch b√© d√πng h√†nh ƒë·ªông ƒë·ªÉ
                n√≥i n√™n l·ªùi y√™u, th√≠ch c·∫£ nh·ªØng c√°i √¥m, nh·ªØng tr√≤ ƒë√πa, nh·ªØng c√°i h√¥n qu√Ω gi√° v√† c·∫£ nh·ªØng l·∫ßn t·ª•i m√¨nh ƒëi date th·∫≠t
                l√† free will, th√≠ch nh·ªØng s·ª± quan t√¢m b√© d√†nh cho tui, nh·ªØng s·ª± c·ªë g·∫Øng cho m·ªëi quan h·ªá c·ªßa t·ª•i m√¨nh,
                th√≠ch c√°ch b·∫°n ch∆°i game v·ª•ng v·ªÅ m√† v·∫´n ki√™n nh·∫´n ch∆°i v·ªõi tui, th√≠ch m√πi th∆°m n∆°i t√≥c b√© khi tui ƒë∆∞·ª£c √¥m,
                th√≠ch c√°ch b√© tr√¥ng th·∫≠t t·ªèa s√°ng trong n·∫Øng (xin l·ªói v√¨ skill ch·ª•p ·∫£nh c·ªßa tui kh√¥ng ƒë·ªß ƒë·ªÉ ch·ª©ng minh c√°i quan ƒëi·ªÉm n√†y),
                th√≠ch vi·ªác b√© cho tui ƒë·ªß s·ª± tin t∆∞·ªüng trong 1 m·ªëi quan h·ªá, th√≠ch c√°ch b√© lu√¥n quan t√¢m ƒë·∫øn tui, th√≠ch "b·ªã ƒë√°nh",
                th√≠ch nh·ªØng g√¨ b·∫°n ƒëang nh√¨n nh·∫≠n v√† h∆∞·ªõng ƒë·∫øn trong m·ªëi quan h·ªá c·ªßa t·ª•i m√¨nh, th√≠ch c√°i chi·ªÅu cao c·ªßa b·∫°n n·ªØa, √† v√†
                th√≠ch s·ª± quan t√¢m v√† t·ª≠ t·∫ø b·∫°n d√†nh cho m·ªçi ng∆∞·ªùi xung quanh m√¨nh n·ªØa. Nhi·ªÅu nhi·ªÅu nhi·ªÅu l·∫Øm b√© ∆°i! Y√™u b√©, tui
                bi·∫øt tui sai khi n√≥i y√™u 1 ng∆∞·ªùi ph·∫£i c·∫ßn c√≥ l√Ω do ch·ª©, nh∆∞ng m√†, b√¢y gi·ªù v·ªõi tui b√© ch√≠nh l√† l√Ω do, v√¨ b√© l√† b√© v√† tui y√™u b√© r·∫•t nhi·ªÅu.
              
                C√≥ nh·ªØng ng√†y m·ªát, ch·ªâ c·∫ßn nh√¨n th·∫•y b√© anh ƒë√£ c·∫£m th·∫•y vui v·∫ª, ch·ªâ c·∫ßn nghe b√© n√≥i v√†i c√¢u l√† anh th·∫•y b√¨nh y√™n h∆°n, ch·ªâ c·∫ßn ƒë∆∞·ª£c √¥m em l√† anh c·∫£m th·∫ø gi·ªõi n√†y th·∫≠t im ·∫Øng ƒë·∫øn l·∫°,
                ch·ªâ c·∫ßn ƒë∆∞·ª£c h√¥n b√©, v·ªã ng·ªçt n∆°i ƒë·∫ßu m√¥i khi·∫øn m·ªçi ƒë·∫Øng cay tr√™n th·∫ø gi·ªõi n√†y ƒë·ªÅu d·ªãu l·∫°i.. Th·∫ø gi·ªõi c·ªßa th·∫±ng Th√†nh n√†y tr·ªü n√™n th·∫≠t y√™n b√¨nh t·ª´ khi c√≥ b√© ƒë·∫øn, d√π hay ƒë∆∞·ª£c b√© c·∫Øn
                y√™u, b√°u y√™u v√† ƒë·∫•m y√™u kakaka.
              </p>

              <p>
                D√π t·ª•i m√¨nh ƒë√£ c√≥ nhi·ªÅu s·ª± bu·ªìn b·ª±c, m·ªát m·ªèi trong th·ªùi gian d·∫°o g·∫ßn ƒë√¢y, tui v·∫´n mu·ªën h·ªçc c√°ch y√™u b√© ƒë√∫ng h∆°n,
                ki√™n nh·∫´n h∆°n v√† t·ª≠ t·∫ø h∆°n. B√© h√£y cho tui bi·∫øt b√© ƒëang c·∫£m th·∫•y sao, c·∫ßn g√¨ v√† mu·ªën g√¨ nh√©. Ng∆∞·ª£c l·∫°i, tui c≈©ng
                s·∫Ω h·ªçc c√°ch ƒë·ªÉ n√≥i ra suy nghƒ© c·ªßa m√¨nh, n√≥i ra mong mu·ªën c·ªßa t·ª•i m√¨nh ƒë·ªÉ m√¨nh hi·ªÉu nhau h∆°n v√† t·ª•i m√¨nh s·∫Ω ƒë∆∞·ª£c l√†
                b·∫£n th√¢n trong m·ªëi quan h·ªá n√†y nh√©.
              </p>

              <p>
                V√† n·∫øu b√© ∆°i, anh c≈©ng mu·ªën m√¨nh c√≥ th√™m th·∫≠t nhi·ªÅu k·ª∑ ni·ªám m·ªõi,
                ƒë·ªÉ sau n√†y nh√¨n l·∫°i s·∫Ω th·∫•y ‚Äú√†, ho√° ra t·ª•i m√¨nh ƒë√£ c·ªë g·∫Øng v√¨ nhau nhi·ªÅu nh∆∞ v·∫≠y v√† ƒë·ªëi ph∆∞∆°ng l√† ng∆∞·ªùi x·ª©ng ƒë√°ng
                ƒë·ªÉ m√¨nh cho ƒëi nhi·ªÅu ƒë·∫øn v·∫≠y.‚Äù D√π y√™u g·∫ßn hay y√™u xa, tui c≈©ng mu·ªën ƒë∆∞·ª£c tr·∫£i qua c√πng b√©, tui mu·ªën tu·ªïi tr·∫ª
                c·ªßa m√¨nh s·∫Ω c√≥ em b√™n ƒë·ªùi, s·∫Ω c√≥ nhi·ªÅu k·ª∑ ni·ªám c√πng b√© v√† t·ª•i m√¨nh s·∫Ω tr·∫£i qua nh·ªØng nƒÉm 20 n√†y th·∫≠t l√† vui v·∫ª nh√©.
                N·∫øu b√© ƒë·ªìng √Ω cho tui c∆° h·ªôi, ƒë·ªìng √Ω b∆∞·ªõc ti·∫øp v·ªõi tui th√¨ ·∫•n next nh√©. Y√™u em. Kh√¥ng ·∫•n tui gi·∫≠n!
              </p>

              <p class="sig">‚Äî Y√™u em, Th√†nh.</p>
              <div style="height:10px"></div>
            </div>

            <div class="scrollBtns" aria-label="N√∫t cu·ªôn th∆∞">
              <button id="btnScrollDown" class="scrollBtn" title="Cu·ªôn xu·ªëng">‚Üì</button>
              <button id="btnScrollUp" class="scrollBtn" title="Cu·ªôn l√™n">‚Üë</button>
            </div>
          </div>
        </div>

        <div class="btnRow">
          <button id="btnOpen">M·ªü th∆∞ ‚úâÔ∏è</button>
          <button id="btnContinue" class="btnGhost">ƒê·ªçc xong r·ªìi üëâ</button>
        </div>
      </div>
    </section>

    <!-- SCENE 2 -->
    <section id="sceneAsk" class="scene">
      <div class="panel">
        <h2 class="subtitle">B√© K·ªãt c√≥ ƒë·ªìng √Ω l√†m Valentine c·ªßa anh kh√¥ng? üíñ</h2>
        <p class="text">Kh√¥ng ch·ªâ nƒÉm nay.. m√† n·∫øu b√© cho ph√©p, c·∫£ nh·ªØng nƒÉm sau v√† nƒÉm sau v√† nƒÉm sau sau n·ªØa nh√©.</p>
        <div class="btnRow">
          <button id="btnYes">ƒê·ªìng √Ω ‚úÖ</button>
          <button id="btnNo" class="btnGhost">ƒê·ªÉ b√© suy nghƒ© th√™m üò≥</button>
        </div>
        <p id="noHint" class="text" style="display:none; margin-top:12px;">
          Ai choooooooo, tui bi·∫øt l√† em s·∫Ω nh·∫•n v√¥ n√∫t n√†y tr∆∞·ªõc! Quay l·∫°i v√† ·∫•n ƒë·ªìng √Ω cho t√¥i - ny ƒëang d·ª±n c·ªßa em -
        </p>
      </div>
    </section>

    <!-- SCENE 3 -->
    <section id="sceneMap" class="scene">
      <div class="panel">
        <h2 class="subtitle">N∆°i m√¨nh g·∫∑p nhau l·∫ßn ƒë·∫ßu üìç</h2>
        <p class="text">B·∫£n ƒë·ªì ·ªü ƒë√¢y, c√≤n c√¢u chuy·ªán th√¨ tui ƒë·ªÉ ngay b√™n c·∫°nh.</p>

        <div class="mapGrid">
          <div class="mapBox">
            <iframe
              id="mapFrame"
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3919.5115795957554!2d106.65532687435655!3d10.77207498937643!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x31752ec3c161a3fb%3A0xef77cd47a1cc691e!2sHCMC%20University%20of%20Technology%20(HCMUT)!5e0!3m2!1sen!2s!4v1770971711669!5m2!1sen!2s"
              title="B·∫£n ƒë·ªì n∆°i g·∫∑p nhau l·∫ßn ƒë·∫ßu">
            </iframe>
          </div>

          <div class="context">
            <p class="k">Chuy·ªán c·ªßa t·ª•i m√¨nh</p>
            <p class="text" style="margin:0;">
              Tui v·∫´n nh·ªõ qu√†i c√°i kho·∫£nh kh·∫Øc ƒë√≥, c√°i gi√¢y ph√∫t l·∫ßn ƒë·∫ßu ti√™n tui nh√¨n th·∫•y em ·ªü t√≤a C4. 
              Em tr√¥ng th·∫≠t r·∫°ng r·ª° d∆∞·ªõi √°nh n·∫Øng b√™n khung c·ª≠a s·ªï ƒë√≥. √Ånh n·∫Øng l√†m t√≥c em th√™m v√†ng, ƒë√¥i m√¥i
              c·ªßa em nh∆∞ mang theo ma l·ª±c l√†m ng∆∞·ªùi kh√°c ƒë·∫Øm ch√¨m v√† em ch·ªâ c·∫ßn ƒë·ª©ng ƒë√≥ th√¥i, c·∫£ th·∫ø gi·ªõi c·ªßa tui
              ƒë√£ d·ª´ng l·∫°i trong kho·∫£nh kh·∫Øc ƒë√≥ r·ªìi. Tui bi·∫øt tui b·ªã em thu h√∫t r·ªìi. Nh·ªØng ng√†y sau ƒë√≥, tui c·ª© l√©n
              nh√¨n em trong l·ªõp ho√†i, ki·∫øm c·ªõ ƒë·ªÉ ng√≥ ngang ng√≥ d·ªçc ƒë·ªÉ ƒë∆∞·ª£c nh√¨n th·∫•y em m·ªôt ch√∫t. L√∫c ƒë√≥ em kh√¥ng
              bi·∫øt ƒë√¢u b√©, tui nh∆∞ con l·∫≠t ƒë·∫≠t v·∫≠y √°, haha nghƒ© l·∫°i m√† th·∫•y ng∆∞·ª£ng. L√∫c nh√≥m tui l√™n thuy·∫øt tr√¨nh, 
              tui c≈©ng l√©n nh√¨n em. C√≥ l√∫c ƒëang ·ªü tr√™n ƒë√≥ m√† th·∫•y em nh√¨n l√™n ch·ªó nh√≥m tui, tim tui kh·ª±ng l·∫°i v√†i 
              nh·ªãp, n√≥ bi·∫øt tui ƒëang nh√¨n ng∆∞·ªùi m√† sau n√†y m√¨nh s·∫Ω th∆∞∆°ng r·∫•t nhi·ªÅu. V√† r·ªìi d∆∞·ªõi g·ªëc c√¢y hoa s·ª©, 
              tui ƒë√£ ƒë∆∞·ª£c g·∫∑p em v√† ti·∫øp th√™m can ƒë·∫£m ƒë·ªÉ b·∫Øt chuy·ªán l√†m quen. Sau t·∫•t c·∫£, d√π sau n√†y tui c√≥ m·∫•t h·∫øt
              k√Ω ·ª©c v·ªÅ th·ªùi ƒë·∫°i h·ªçc th√¨ kho·∫£ng th·ªùi gian n√†y v√† kho·∫£ng th·ªùi gian sau n√†y v·ªõi b√© s·∫Ω l√† th·ª© tui gi·ªØ 
              l·∫°i cu·ªëi c√πng cho b·∫£n th√¢n m√¨nh. C·∫£m ∆°n b√© v√¨ ƒë√£ ƒë·ªçc ƒë·∫øn ƒë√¢y, l√∫c ƒëang vi·∫øt nh·ªØng d√≤ng n√†y, tui b·∫•t
              gi√°c nh·ªõ l·∫°i kho·∫£ng th·ªùi gian khi m√¨nh b√™n nhau ·∫•y v√† tui c·∫£m th·∫•y r·∫•t vui, tui c·∫£m ∆°n ƒë·ªãnh m·ªánh, v≈© 
              tr·ª•, cupid hay b·∫•t c·ª© th·ª© g√¨ ƒë√≥ ƒë√£ ƒë∆∞a em ƒë·∫øn v·ªõi tui. Tui s·∫Ω lu√¥n tr√¢n tr·ªçn em, tr√¢n tr·ªçng kho·∫£ng 
              th·ªùi gian n√†y v√† tr√¢n tr·ªçng t√¨nh y√™u c·ªßa t·ª•i m√¨nh. 
              K·∫øt chuy·ªán, tui mong r·∫±ng l·∫ßn ƒë·∫ßu ti√™n tui th·∫•y em, em di·ªán cho m√¨nh b·ªô ƒë·ªì tr·∫Øng
              c·ªßa tr∆∞·ªùng b√°ch khoa th√¨ sau n√†y c≈©ng s·∫Ω ƒë∆∞·ª£c th·∫•y em trong chi·∫øc v√°y c∆∞·ªõi m√†u tr·∫Øng tinh nh√©. Lttyvkma.
              <br><br>
              V√† h√£y ƒë√°nh d·∫•u th·∫≠t nhi·ªÅu ƒëi·ªÉm tr√™n b·∫£n ƒë·ªì c√πng nhau trong h√†nh tr√¨nh c·ªßa t·ª•i m√¨nh nha b√©
            </p>
            <div class="btnRow" style="justify-content:flex-start; margin-top:14px;">
              <button id="btnToFinal"> Lets gooo üëâ</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- SCENE 4 -->
    <section id="sceneFinal" class="scene">
      <div class="panel" id="finalCard">
        <h2 class="subtitle">Happy Valentine ‚ù§Ô∏è</h2>
        <p class="text">
          Anh th∆∞∆°ng b√© K·ªãt r·∫•t nhi·ªÅu. <br>
          C·∫£m ∆°n v√¨ ƒë√£ ƒë·ªìng h√†nh c√πng anh nha b√© v√† t·ª•i m√¨nh
          h√£y ƒë·ªìng h√†nh c√πng nhau l√¢u th·∫≠t l√† l√¢u nha b√©. Th∆∞∆°ng em.
        </p>
        <img class="photo" src="·∫£nh ƒë√¥i.jpg" alt="·∫¢nh ƒë√¥i">
      </div>
    </section>

  </div>

  <script>
    const $ = (id) => document.getElementById(id);
    const sceneEnvelope = $("sceneEnvelope");
    const sceneAsk = $("sceneAsk");
    const sceneMap = $("sceneMap");
    const sceneFinal = $("sceneFinal");
    const envelope = $("envelope");
    const bgm = $("bgm");
    const envPanel = $("envPanel");
    const letterContent = $("letterContent");

    function showScene(scene){
      for (const s of [sceneEnvelope, sceneAsk, sceneMap, sceneFinal]) s.classList.remove("active");
      scene.classList.add("active");
    }

    async function tryPlayMusic(){
      try{
        bgm.volume = 0.85;
        await bgm.play();
      }catch(e){
        console.log("Autoplay blocked:", e);
      }
    }

    // Hearts tr√°nh ƒë√® panel
    function rand(min, max){ return Math.random() * (max - min) + min; }

    function getNoSpawnZone(){
      const activePanel = document.querySelector(".scene.active .panel");
      const r = activePanel.getBoundingClientRect();
      const pad = Math.max(16, Math.round(Math.min(innerWidth, innerHeight) * 0.05));
      return { left:r.left-pad, right:r.right+pad, top:r.top-pad, bottom:r.bottom+pad };
    }

    function pickSpawnPoint(){
      const z = getNoSpawnZone();
      const W = innerWidth, H = innerHeight;
      for(let i=0;i<14;i++){
        const x = rand(0, W);
        const y = rand(0, H);
        const inside = (x>=z.left && x<=z.right && y>=z.top && y<=z.bottom);
        if(!inside) return {x,y};
      }
      return {x: rand(0,W), y: rand(0,40)};
    }

    function spawnHeart(){
      const {x,y} = pickSpawnPoint();
      const heart = document.createElement("div");
      heart.className = "heart";
      heart.textContent = "‚ù§Ô∏è";

      const minSize = Math.max(16, Math.min(innerWidth, innerHeight) * 0.028);
      const maxSize = Math.max(26, Math.min(innerWidth, innerHeight) * 0.052);
      heart.style.fontSize = rand(minSize, maxSize) + "px";

      heart.style.left = x + "px";
      heart.style.top  = y + "px";

      const drift = rand(-50, 50);
      heart.style.setProperty("--x0", "0px");
      heart.style.setProperty("--x1", drift + "px");

      const isMobile = matchMedia("(max-width: 600px)").matches;
      const duration = isMobile ? rand(5.8, 7.8) : rand(6.2, 9.2);
      heart.style.animationDuration = duration + "s";

      document.body.appendChild(heart);
      setTimeout(() => heart.remove(), duration * 1000 + 200);
    }

    const isMobile = matchMedia("(max-width: 600px)").matches;
    setInterval(spawnHeart, isMobile ? 650 : 450);

    // ===== Flow =====
    $("btnOpen").addEventListener("click", async () => {
      envelope.classList.add("open");
      envPanel.classList.add("opened");
      await tryPlayMusic();

      // khi m·ªü th∆∞: ƒë∆∞a scroll v·ªÅ ƒë·∫ßu ƒë·ªÉ b√© ƒë·ªçc t·ª´ ƒë·∫ßu
      if(letterContent) letterContent.scrollTop = 0;
    });

    $("btnContinue").addEventListener("click", () => {
      showScene(sceneAsk);
    });

    $("btnNo").addEventListener("click", () => {
      $("noHint").style.display = "block";
    });

    $("btnYes").addEventListener("click", () => {
      showScene(sceneMap);
    });

    $("btnToFinal").addEventListener("click", () => {
      showScene(sceneFinal);
    });

    // ===== N√∫t cu·ªôn th∆∞ =====
    function scrollLetter(delta){
      if(!letterContent) return;
      letterContent.scrollBy({ top: delta, behavior: "smooth" });
    }

    $("btnScrollDown").addEventListener("click", () => scrollLetter(220));
    $("btnScrollUp").addEventListener("click", () => scrollLetter(-220));

    // ·∫®n/hi·ªán n√∫t theo v·ªã tr√≠ cu·ªôn
    function updateScrollButtons(){
      if(!letterContent) return;
      const up = $("btnScrollUp");
      const down = $("btnScrollDown");
      const atTop = letterContent.scrollTop <= 2;
      const atBottom = letterContent.scrollTop + letterContent.clientHeight >= letterContent.scrollHeight - 2;

      up.style.opacity = atTop ? 0.35 : 1;
      down.style.opacity = atBottom ? 0.35 : 1;
    }
    if(letterContent){
      letterContent.addEventListener("scroll", updateScrollButtons);
      updateScrollButtons();
    }
  </script>
</body>
</html>
