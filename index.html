<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Thi·ªáp Valentine</title>

  <style>
    :root{
      /* Thang responsive t·ªïng (d√πng clamp ƒë·ªÉ co gi√£n m∆∞·ª£t) */
      --pad: clamp(18px, 4vw, 40px);
      --radius: clamp(14px, 3vw, 22px);
      --cardW: min(560px, calc(100vw - 32px));
      --h2: clamp(22px, 3.6vw, 34px);
      --p: clamp(14px, 2.3vw, 18px);
      --btn: clamp(14px, 2.4vw, 16px);
      --imgW: clamp(200px, 55vw, 320px);

      --heartMin: clamp(16px, 2.8vw, 24px);
      --heartMax: clamp(26px, 4.6vw, 42px);
    }

    body{
      margin:0;
      font-family: "Segoe UI", sans-serif;
      background: linear-gradient(135deg,#ff9a9e,#fad0c4);
      display:flex;
      justify-content:center;
      align-items:center;
      min-height:100vh;
      text-align:center;
      overflow:hidden;
    }

    .container{
      position:relative;
      z-index:3;
      background:#fff;
      padding: var(--pad);
      border-radius: var(--radius);
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      width: var(--cardW);
      animation: fadeIn 1.2s ease;
    }

    h2{
      margin: 0 0 12px 0;
      font-size: var(--h2);
      line-height: 1.15;
    }

    p{
      margin: 0 0 16px 0;
      font-size: var(--p);
      line-height: 1.6;
    }

    button{
      padding: clamp(10px, 2.6vw, 12px) clamp(18px, 4.5vw, 26px);
      background:#ff4d6d;
      color:#fff;
      border:none;
      border-radius:999px;
      cursor:pointer;
      font-size: var(--btn);
    }
    button:hover{ background:#e60039; }

    .photo{
      display:block;
      width: var(--imgW);
      max-width:100%;
      height:auto;
      margin: 14px auto 0 auto;
      border-radius: clamp(10px, 2.5vw, 16px);
    }

    @keyframes fadeIn{
      from{opacity:0; transform:translateY(18px);}
      to{opacity:1; transform:translateY(0);}
    }

    /* Tim bay */
    .heart{
      position:fixed;
      z-index:2;            /* d∆∞·ªõi card */
      pointer-events:none;
      left:0;
      top:0;
      opacity:0;
      will-change: transform, opacity;
      animation-name: floatUp;
      animation-timing-function: linear;
      animation-fill-mode: forwards;
      filter: drop-shadow(0 4px 10px rgba(0,0,0,0.18));
    }

    /* Bay t·ª´ d∆∞·ªõi l√™n + h∆°i l·ªách ngang */
    @keyframes floatUp{
      0%   { transform: translate(var(--x0), 110vh) rotate(0deg); opacity:0; }
      12%  { opacity:1; }
      100% { transform: translate(var(--x1), -20vh) rotate(360deg); opacity:0; }
    }

    /* T√¥n tr·ªçng ng∆∞·ªùi d√πng gi·∫£m chuy·ªÉn ƒë·ªông */
    @media (prefers-reduced-motion: reduce){
      .heart{ animation: none; opacity: 0; }
      .container{ animation: none; }
    }
  </style>
</head>

<body>
  <div class="container" id="card">
    <h2>üíñ G·ª≠i b√© K·ªãt üíñ</h2>
    <p>
      Will you be my valentine this year bbi?<br>
      It's been 4 months and we have been through ups and downs,
      even after that, I still want you to be my valentine
      for this year and for years forever after.
    </p>
    <button onclick="openCard()">B·∫•m v√†o ƒë√¢y</button>
  </div>

  <script>
    const card = document.getElementById("card");

    function openCard(){
      card.innerHTML = `
        <h2>Happy Valentine ‚ù§Ô∏è</h2>
        <p>
          Anh th∆∞∆°ng b√© K·ªãt r·∫•t nhi·ªÅu. <br>
          C·∫£m ∆°n v√¨ ƒë√£ ƒë·ªìng h√†nh c√πng anh nha b√© v√† mong l√† t·ª•i m√¨nh
          s·∫Ω ƒë·ªìng h√†nh c√πng nhau l√¢u th·∫≠t l√¢u
        </p>
        <img class="photo" src="·∫£nh ƒë√¥i.jpg" alt="·∫¢nh ƒë√¥i">
      `;
    }

    // L·∫•y v√πng c·∫•m spawn (theo card), c√≥ th√™m "ƒë·ªám" ƒë·ªÉ tim kh√¥ng ch·∫°m s√°t card
    function getNoSpawnZone(){
      const r = card.getBoundingClientRect();
      const pad = Math.max(16, Math.round(Math.min(window.innerWidth, window.innerHeight) * 0.04)); // ~4% m√†n h√¨nh
      return {
        left: r.left - pad,
        right: r.right + pad,
        top: r.top - pad,
        bottom: r.bottom + pad
      };
    }

    function rand(min, max){ return Math.random() * (max - min) + min; }

    // Ch·ªçn ƒëi·ªÉm spawn (x,y) "kh·∫Øp m√†n h√¨nh" nh∆∞ng tr√°nh v√πng c·∫•m
    function pickSpawnPoint(){
      const zone = getNoSpawnZone();
      const W = window.innerWidth;
      const H = window.innerHeight;

      // th·ª≠ t·ªëi ƒëa 12 l·∫ßn ƒë·ªÉ t√¨m ƒëi·ªÉm h·ª£p l·ªá
      for(let i=0;i<12;i++){
        const x = rand(0, W);
        const y = rand(0, H);  // spawn kh·∫Øp m√†n h√¨nh (kh√¥ng ch·ªâ d∆∞·ªõi)
        const inside =
          x >= zone.left && x <= zone.right &&
          y >= zone.top  && y <= zone.bottom;

        if(!inside) return {x, y};
      }

      // fallback: n·∫øu hi·∫øm khi kh√¥ng t√¨m ƒë∆∞·ª£c, spawn ·ªü m√©p
      return {x: rand(0, W), y: rand(0, 40)};
    }

    function spawnHeart(){
      const {x, y} = pickSpawnPoint();

      const heart = document.createElement("div");
      heart.className = "heart";
      heart.textContent = "‚ù§Ô∏è";

      // K√≠ch th∆∞·ªõc tim responsive
      const root = getComputedStyle(document.documentElement);
      const hMin = parseFloat(root.getPropertyValue("--heartMin"));
      const hMax = parseFloat(root.getPropertyValue("--heartMax"));
      const size = rand(hMin, hMax);
      heart.style.fontSize = size + "px";

      // ƒê·∫∑t v·ªã tr√≠ spawn t·∫°i (x,y)
      heart.style.left = x + "px";
      heart.style.top  = y + "px";

      // ƒê·ªô l·ªách ngang khi bay (nh·∫π nh√†ng)
      const drift = rand(-40, 40);           // px
      heart.style.setProperty("--x0", "0px");
      heart.style.setProperty("--x1", drift + "px");

      // T·ªëc ƒë·ªô bay random (nh·∫π h∆°n tr√™n mobile)
      const isMobile = window.matchMedia("(max-width: 600px)").matches;
      const duration = isMobile ? rand(5.5, 7.5) : rand(6, 9);
      heart.style.animationDuration = duration + "s";

      document.body.appendChild(heart);
      setTimeout(() => heart.remove(), duration * 1000 + 200);
    }

    // Nh·ªãp spawn: mobile th∆∞a h∆°n ƒë·ªÉ m∆∞·ª£t
    function startHearts(){
      const isMobile = window.matchMedia("(max-width: 600px)").matches;
      const interval = isMobile ? 650 : 450;
      setInterval(spawnHeart, interval);
    }

    startHearts();

    // Khi xoay m√†n h√¨nh / resize: kh√¥ng c·∫ßn l√†m g√¨ nhi·ªÅu, v√¨ m·ªói l·∫ßn spawn s·∫Ω t√≠nh v√πng c·∫•m m·ªõi
  </script>
</body>
</html>
